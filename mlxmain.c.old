/* ************************************************************************** */
/*                                                                            */
/*                                                        :::      ::::::::   */
/*   testmlx.c                                          :+:      :+:    :+:   */
/*                                                    +:+ +:+         +:+     */
/*   By: magrab <marvin@42.fr>                      +#+  +:+       +#+        */
/*                                                +#+#+#+#+#+   +#+           */
/*   Created: 2018/12/18 18:15:27 by magrab            #+#    #+#             */
/*   Updated: 2019/01/18 22:02:09 by magrab           ###   ########.fr       */
/*                                                                            */
/* ************************************************************************** */

#include "fdf.h"

t_value	**calcmap(int setup)
{
	static t_value **test;

	if (setup == 1)
	{
		test = malloc(5 * sizeof(t_value **));
		test[0] = malloc(3 * sizeof(t_value));
		test[0][0].x = 0;
		test[0][0].y = 0;
		test[0][0].z = 0;
		test[0][0].c = 0xFF0000;
		test[0][1].x = 0;
		test[0][1].y = 0;
		test[0][1].z = 10;
		test[0][1].c = 0xFF8000;
		test[0][2].c = -42;
		test[1] = malloc(3 * sizeof(t_value));
		test[1][0].x = 0;
		test[1][0].y = 10;
		test[1][0].z = 0;
		test[1][0].c = 0xFF0080;
		test[1][1].x = 0;
		test[1][1].y = 10;
		test[1][1].z = 10;
		test[1][1].c = 0xFFFFFF;
		test[1][2].c = -42;
		test[2] = malloc(3 * sizeof(t_value));
		test[2][0].x = 10;
		test[2][0].y = 0;
		test[2][0].z = 0;
		test[2][0].c = 0xFFFFFF;
		test[2][1].x = 10;
		test[2][1].y = 0;
		test[2][1].z = 10;
		test[2][1].c = 0xFFFFFF;
		test[2][2].c = -42;
		test[3] = malloc(3 * sizeof(t_value));
		test[3][0].x = 10;
		test[3][0].y = 10;
		test[3][0].z = 0;
		test[3][0].c = 0xFFFFFF;
		test[3][1].x = 10;
		test[3][1].y = 10;
		test[3][1].z = 10;
		test[3][1].c = 0xFFFFFF;
		test[3][2].c = -42;
		test[4] = NULL;
	}
	return (test);
}

//void	draw_line(int x0, int y0, int x1, int y1)
int		drawmap(t_value **test, int dx, int dy, int space)
{
	int x;
	int y;

	x = 0;
	y = 0;
	mlx_clear_window(g_mlx(0), g_win(0));
	if (!test)
		return (-1);
	while (test[x])
	{
		while (test[x][y].c != -42 && test[x][y + 1].c != -42)
		{
			draw_line(
		//	mlx_pixel_put(g_mlx, g_win(0),
					WINX/2 + (dx + test[x][y].x)*space/(20 + test[x][y].z),
					WINY/2 + (dy + test[x][y].y)*space/(20 + test[x][y].z),
		//			test[x][y].c);
					WINX/2 + (dx + test[x][y + 1].x)*space/(20 + test[x][y + 1].z),
					WINY/2 + (dy + test[x][y + 1].y)*space/(20 + test[x][y + 1].z));
			y++;
		}
		y = 0;
		x++;
	}
	return (0);
}

int		main(void)
{
	t_win window;

	window.sizex = WINX;
	window.sizey = WINY;
	window.title = "TEST";
	if (!g_mlx(1))
		return (-1);
	if (!(g_win(&window)))
		return (-1);
	
	mlx_mouse_hook(g_win(0), mouse_hook, g_win(0));
	mlx_hook(g_win(0), 2, 0, key_press, g_win(0));
	mlx_hook(g_win(0), 3, 0, key_release, g_win(0));
	//mlx_hook(g_win(0), 6, 0, mouse_move, g_win(0));

	calcmap(1);

	//drawmap(calcmap(0), WINX / 2 - 50, WINY / 2 - 50, 50);

	mlx_loop(g_mlx(0));
	return (0);
}
